C
C Function to compute the free-free gaunt factors for a
C hydrogenic ion of charge Z. The gaunt facors are derived
C from a table in ATLAS (1970) which in turn was derived
C from the results of Karzas and Latter. The first 6 values
C for U=0.5 have been correctd by the addition of 0.1 . The
C frequency should be given in units of 1.0E+15 Hz and the
C temperature in units of 1.0E+04 K .
C
	FUNCTION GFF(RNU,T,ZION)
	IMPLICIT NONE
C
C Altered 21-Jun-1998 : D0's inserted.
C Altered 07-Dec-1991 : Ifs replaced by MIN and MAX functions.
C                       GFF_VEC subroutine included.
C
	REAL*8 RNU,T,ZION,GFF
C
	REAL*8 U,GB,DU,DGB
	INTEGER IU,IGB
C
	REAL*8, SAVE :: A(12,11)
	DATA A
	1/ 5.53D0,4.91D0,4.29D0,3.64D0,3.00D0,2.41D0,1.87D0,1.33D0,0.90D0,0.55D0,0.33D0,0.19D0
	1, 5.49D0,4.87D0,4.25D0,3.61D0,2.98D0,2.41D0,1.89D0,1.39D0,0.95D0,0.59D0,0.36D0,0.21D0
	1, 5.46D0,4.84D0,4.22D0,3.59D0,2.97D0,2.41D0,1.91D0,1.44D0,1.00D0,0.63D0,0.39D0,0.24D0
	1, 5.43D0,4.80D0,4.18D0,3.56D0,2.95D0,2.41D0,1.93D0,1.49D0,1.08D0,0.72D0,0.46D0,0.28D0
	1, 5.40D0,4.77D0,4.15D0,3.54D0,2.94D0,2.41D0,1.95D0,1.55D0,1.17D0,0.86D0,0.59D0,0.38D0
	1, 5.25D0,4.63D0,4.02D0,3.41D0,2.81D0,2.32D0,1.90D0,1.56D0,1.30D0,1.01D0,0.76D0,0.53D0
	1, 5.00D0,4.40D0,3.80D0,3.22D0,2.65D0,2.19D0,1.80D0,1.51D0,1.32D0,1.14D0,0.97D0,0.76D0
	1, 4.69D0,4.13D0,3.57D0,2.97D0,2.44D0,2.02D0,1.68D0,1.42D0,1.30D0,1.18D0,1.09D0,0.96D0
	1, 4.48D0,3.87D0,3.27D0,2.70D0,2.21D0,1.84D0,1.52D0,1.33D0,1.20D0,1.15D0,1.13D0,1.08D0
	1, 4.16D0,3.52D0,2.98D0,2.45D0,2.01D0,1.67D0,1.41D0,1.25D0,1.15D0,1.11D0,1.10D0,1.09D0
	1, 3.85D0,3.27D0,2.70D0,2.20D0,1.81D0,1.50D0,1.30D0,1.17D0,1.11D0,1.08D0,1.08D0,1.09D0/
C
	U=LOG10(4.7994D0*RNU/T)
	U=MAX(-3.99999999D0,U)
	U=MIN(1.499999D0,U)
	GB=LOG10(15.789D0*ZION*ZION/T)
	GB=MAX(-2.99999999D0,GB)
	GB=MIN(1.999999D0,GB)
	IU=INT(U*2+9.0D0)
	IGB=INT(GB*2+7.0D0)
	DU=2*U+9.0D0-IU
	DGB=2*GB+7.0D0-IGB
C
	GFF=((1.0D0-DU)*A(IU,IGB)+DU*A(IU+1,IGB))*(1.0D0-DGB)
	1 +((1.0D0-DU)*A(IU,IGB+1)+DU*A(IU+1,IGB+1))*DGB
C
	RETURN
	END
C
C 
C
	SUBROUTINE GFF_VEC(GFF_VAL,RNU,T,ZION,ND)
	IMPLICIT NONE
	INTEGER ND
	REAL*8 ZION  		!Ion charge
	REAL*8 RNU		!Frequency in units of 10^15 Hz
	REAL*8 T(ND)		!T in units 10^4 K
	REAL*8 GFF_VAL(ND)	!Returned free-free Gaunt factors.
C
C Important data
C
	REAL*8, SAVE :: A(12,11)
	DATA A
	1/ 5.53D0,4.91D0,4.29D0,3.64D0,3.00D0,2.41D0,1.87D0,1.33D0,0.90D0,0.55D0,0.33D0,0.19D0
	1, 5.49D0,4.87D0,4.25D0,3.61D0,2.98D0,2.41D0,1.89D0,1.39D0,0.95D0,0.59D0,0.36D0,0.21D0
	1, 5.46D0,4.84D0,4.22D0,3.59D0,2.97D0,2.41D0,1.91D0,1.44D0,1.00D0,0.63D0,0.39D0,0.24D0
	1, 5.43D0,4.80D0,4.18D0,3.56D0,2.95D0,2.41D0,1.93D0,1.49D0,1.08D0,0.72D0,0.46D0,0.28D0
	1, 5.40D0,4.77D0,4.15D0,3.54D0,2.94D0,2.41D0,1.95D0,1.55D0,1.17D0,0.86D0,0.59D0,0.38D0
	1, 5.25D0,4.63D0,4.02D0,3.41D0,2.81D0,2.32D0,1.90D0,1.56D0,1.30D0,1.01D0,0.76D0,0.53D0
	1, 5.00D0,4.40D0,3.80D0,3.22D0,2.65D0,2.19D0,1.80D0,1.51D0,1.32D0,1.14D0,0.97D0,0.76D0
	1, 4.69D0,4.13D0,3.57D0,2.97D0,2.44D0,2.02D0,1.68D0,1.42D0,1.30D0,1.18D0,1.09D0,0.96D0
	1, 4.48D0,3.87D0,3.27D0,2.70D0,2.21D0,1.84D0,1.52D0,1.33D0,1.20D0,1.15D0,1.13D0,1.08D0
	1, 4.16D0,3.52D0,2.98D0,2.45D0,2.01D0,1.67D0,1.41D0,1.25D0,1.15D0,1.11D0,1.10D0,1.09D0
	1, 3.85D0,3.27D0,2.70D0,2.20D0,1.81D0,1.50D0,1.30D0,1.17D0,1.11D0,1.08D0,1.08D0,1.09D0/
C
C Local Variables.
C
	INTEGER I,IU,IGB
	REAL*8 U,GB,DU,DGB,A1,A2,LOGT
C
	A1=LOG10(4.7994D0*RNU)
	A2=LOG10(15.789D0*ZION*ZION)
	DO I=1,ND
	  LOGT=LOG10(T(I))
	  U=A1-LOGT
	  U=MAX(-3.99999999D0,U)
	  U=MIN(1.499999D0,U)
	  GB=A2-LOGT
	  GB=MAX(-2.99999999D0,GB)
	  GB=MIN(1.999999D0,GB)
C
	  IU=INT(U*2+9.0D0)
	  IGB=INT(GB*2+7.0D0)
	  DU=2*U+9.0D0-IU
	  DGB=2*GB+7.0D0-IGB
	  GFF_VAL(I)=((1.0D0-DU)*A(IU,IGB)+DU*A(IU+1,IGB))*(1.0D0-DGB)
	1               +((1.0D0-DU)*A(IU,IGB+1)+DU*A(IU+1,IGB+1))*DGB
	END DO
C
	RETURN
	END
