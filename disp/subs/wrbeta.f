	SUBROUTINE WRBETA(CHIL,SIGMA,BETA,R,V,FREQ,ND)
	IMPLICIT DOUBLE PRECISION (A-H,O-Z)
	DIMENSION Y(1001),CHIL(ND),BETA(ND),R(ND),V(ND),SIGMA(ND)
	H=0.01
C
	DO 1000 I=1,ND
C
	TAU=3.0E-10*CHIL(I)*R(I)/V(I)/FREQ
	SIG1=1.0+SIGMA(I)
C
	DO 10 K=1,101
	X=1.0+SIGMA(I)*H*H*(K-1)*(K-1)
	Y(K)=(1.0-DEXP(-TAU/X))*X/TAU
10	CONTINUE
C
	S=DSQRT(DABS(SIGMA(I)))
	IF(SIGMA(I) .EQ. 0)THEN
			VV=1.0
	ELSE IF(SIGMA(I) .GT. 0)THEN
			VV=DATAN(S)/S
	ELSE
			VV=0.5*DLOG((1.0+S)/(1.0-S))/S
	END IF
C
C
	IF(TAU .LT. 0.1 .AND. TAU .LT. 0.1*SIG1)THEN
		T1=0.5*TAU
		T2=TAU*TAU/12.0
		T3=T2*TAU*0.1875
		BETA(I)=1.0-(T1+T3-T2)*VV+(T2-T3)/SIG1
	ELSE IF(TAU .GT. 10 .AND. TAU .GT. 10.0*SIG1)THEN
		BETA(I)=(1.0+SIGMA(I)/3.0)/TAU
	ELSE
		BETA(I)=0.0
		DO 200 J=1,99,2
		BETA(I)=BETA(I)+Y(J)+4.0*Y(J+1)+Y(J+2)
200		CONTINUE
		BETA(I)=BETA(I)*H/3.0
	END IF
C
C
1000	CONTINUE
C
	RETURN
	END
